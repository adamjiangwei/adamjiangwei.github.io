<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>阿当的手搓简易博客</title>
  <style>
    body {
      font-family: "Segoe UI", "微软雅黑", sans-serif;
      margin: 0;
      background: #f4f6f9;
    }
    header {
      background: #3f51b5;
      color: white;
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    header h1 { margin: 0; font-size: 20px; }
    #loginMenu { position: relative; }
    #loginToggle {
      background: #fff;
      color: #3f51b5;
      border: none;
      padding: 6px 12px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
    }
    #loginBox {
      display: none;
      position: absolute;
      right: 0;
      top: 40px;
      background: white;
      border: 1px solid #ccc;
      border-radius: 6px;
      padding: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
      z-index: 99;
    }
    input[type="text"], input[type="password"], textarea {
      width: 100%;
      padding: 8px;
      margin: 6px 0;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    button {
      background: #3f51b5;
      color: white;
      border: none;
      padding: 8px 14px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: bold;
    }
    button:hover { background: #2c3e9d; }
    main { padding: 20px; max-width: 800px; margin: auto; }
    #editor, .post {
      background: white;
      border-radius: 8px;
      padding: 15px;
      margin: 20px 0;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .post b { color: #3f51b5; }
    .messages { margin-top: 10px; }
    .message {
      background: #f1f1f1;
      border-radius: 6px;
      padding: 6px;
      margin-top: 6px;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <header>
    <h1>阿当的手搓简易博客</h1>
    <div id="loginMenu">
      <button id="loginToggle" onclick="toggleLogin()">登录</button>
      <div id="loginBox">
        <div id="loginForm">
          <input id="username" type="text" placeholder="账号">
          <input id="password" type="password" placeholder="密码">
          <button onclick="login()">登录</button>
        </div>
        <div id="userPanel" class="hidden">
          欢迎，<span id="userName"></span><br>
          <button onclick="logout()">退出</button>
        </div>
      </div>
    </div>
  </header>

  <main>
    <!-- 发文章 -->
    <div id="editor" class="hidden">
      <h2>发文章</h2>
      <textarea id="postContent" placeholder="写点什么..."></textarea><br>
      <button onclick="addPost()">发布</button>
    </div>

    <!-- 文章列表 -->
    <h2>文章</h2>
    <div id="postList"></div>
  </main>

  <script>
    const USERS = { "adam": "Aa@123456" }; // 模拟账号
    let currentUser = null;

    function toggleLogin() {
      const box = document.getElementById("loginBox");
      box.style.display = box.style.display === "block" ? "none" : "block";
    }

    function login() {
      const user = document.getElementById("username").value;
      const pass = document.getElementById("password").value;
      if (USERS[user] && USERS[user] === pass) {
        currentUser = user;
        document.getElementById("loginForm").classList.add("hidden");
        document.getElementById("userPanel").classList.remove("hidden");
        document.getElementById("userName").innerText = user;
        document.getElementById("editor").classList.remove("hidden");
        document.getElementById("loginToggle").innerText = "账户";
      } else {
        alert("账号或密码错误！");
      }
    }

    function logout() {
      currentUser = null;
      document.getElementById("loginForm").classList.remove("hidden");
      document.getElementById("userPanel").classList.add("hidden");
      document.getElementById("editor").classList.add("hidden");
      document.getElementById("loginToggle").innerText = "登录";
    }

    function addPost() {
      if (!currentUser) return;
      const content = document.getElementById("postContent").value.trim();
      if (!content) return;
      const posts = JSON.parse(localStorage.getItem("posts") || "[]");
      const id = Date.now();
      posts.unshift({ id, user: currentUser, content, time: new Date().toLocaleString(), messages: [] });
      localStorage.setItem("posts", JSON.stringify(posts));
      document.getElementById("postContent").value = "";
      renderPosts();
    }

    function addMessage(postId) {
      const input = document.getElementById("msg-" + postId);
      const text = input.value.trim();
      if (!text) return;
      const posts = JSON.parse(localStorage.getItem("posts") || "[]");
      const post = posts.find(p => p.id === postId);
      post.messages.unshift({ content: text, time: new Date().toLocaleString() });
      localStorage.setItem("posts", JSON.stringify(posts));
      input.value = "";
      renderPosts();
    }

    function renderPosts() {
      const posts = JSON.parse(localStorage.getItem("posts") || "[]");
      const list = document.getElementById("postList");
      list.innerHTML = posts.map(p => `
        <div class="post">
          <b>${p.user}</b> (${p.time})<br><br>${p.content}
          <div class="messages">
            <h4>留言</h4>
            ${p.messages.map(m => `<div class="message">匿名 (${m.time})<br>${m.content}</div>`).join("")}
            <textarea id="msg-${p.id}" placeholder="匿名留言..."></textarea><br>
            <button onclick="addMessage(${p.id})">留言</button>
          </div>
        </div>
      `).join("");
    }

    // 初始化
    renderPosts();
  </script>
</body>
</html>
