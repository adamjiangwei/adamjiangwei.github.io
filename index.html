<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>阿当的简易博客 + 留言板</title>
  <style>
    body { font-family: sans-serif; margin: 20px; }
    .hidden { display: none; }
    .post, .message { border: 1px solid #ccc; padding: 10px; margin: 10px 0; border-radius: 8px; }
    h2 { margin-top: 30px; }
    textarea { width: 100%; height: 60px; }
    input[type="text"], input[type="password"] { width: 200px; }
  </style>
</head>
<body>
  <h1>阿当的小博客</h1>

  <!-- 登录 -->
  <div id="loginBox">
    <h2>登录</h2>
    <input id="username" type="text" placeholder="账号"><br>
    <input id="password" type="password" placeholder="密码"><br>
    <button onclick="login()">登录</button>
  </div>

  <!-- 发文章 -->
  <div id="editor" class="hidden">
    <h2>发文章</h2>
    <textarea id="postContent" placeholder="写点什么..."></textarea><br>
    <button onclick="addPost()">发布</button>
    <button onclick="logout()">退出</button>
  </div>

  <!-- 文章列表 -->
  <h2>文章</h2>
  <div id="postList"></div>

  <!-- 匿名留言 -->
  <h2>匿名留言板</h2>
  <textarea id="messageContent" placeholder="随便说点什么..."></textarea><br>
  <button onclick="addMessage()">留言</button>
  <div id="messageList"></div>

  <script>
    const USERS = { "admin": "Aa@123456" }; // 模拟账号密码
    let currentUser = null;

    function login() {
      const user = document.getElementById("username").value;
      const pass = document.getElementById("password").value;
      if (USERS[user] && USERS[user] === pass) {
        currentUser = user;
        document.getElementById("loginBox").classList.add("hidden");
        document.getElementById("editor").classList.remove("hidden");
      } else {
        alert("账号或密码错误！");
      }
    }

    function logout() {
      currentUser = null;
      document.getElementById("loginBox").classList.remove("hidden");
      document.getElementById("editor").classList.add("hidden");
    }

    function addPost() {
      if (!currentUser) return;
      const content = document.getElementById("postContent").value;
      if (!content) return;
      const posts = JSON.parse(localStorage.getItem("posts") || "[]");
      posts.unshift({ user: currentUser, content, time: new Date().toLocaleString() });
      localStorage.setItem("posts", JSON.stringify(posts));
      document.getElementById("postContent").value = "";
      renderPosts();
    }

    function renderPosts() {
      const posts = JSON.parse(localStorage.getItem("posts") || "[]");
      const list = document.getElementById("postList");
      list.innerHTML = posts.map(p => 
        `<div class="post"><b>${p.user}</b> (${p.time})<br>${p.content}</div>`
      ).join("");
    }

    function addMessage() {
      const content = document.getElementById("messageContent").value;
      if (!content) return;
      const msgs = JSON.parse(localStorage.getItem("messages") || "[]");
      msgs.unshift({ content, time: new Date().toLocaleString() });
      localStorage.setItem("messages", JSON.stringify(msgs));
      document.getElementById("messageContent").value = "";
      renderMessages();
    }

    function renderMessages() {
      const msgs = JSON.parse(localStorage.getItem("messages") || "[]");
      const list = document.getElementById("messageList");
      list.innerHTML = msgs.map(m => 
        `<div class="message">匿名 (${m.time})<br>${m.content}</div>`
      ).join("");
    }

    // 初始化渲染
    renderPosts();
    renderMessages();
  </script>
</body>
</html>

